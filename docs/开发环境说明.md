# 拼图游戏项目开发环境说明文档

## 项目概述

这是一个基于Qt框架的跨平台拼图游戏应用程序，支持多种难度级别（3x3、4x4、8x8等），具有拖拽操作、图片旋转、自定义图片选择和网络功能等特性。

## 系统要求

### 硬件要求
- **处理器**: x86_64 架构（项目配置支持）
- **内存**: 最低4GB RAM，推荐8GB以上
- **存储**: 至少500MB可用空间（包含图片资源和编译输出）

### 软件要求
- **操作系统**: macOS 10.15+ (当前环境), Windows, Linux
- **Qt版本**: 6.9.0+ (已测试)
- **C++标准**: C++11+
- **构建工具**: Make 3.81+
- **编译器**: 
  - macOS: Clang/clang++
  - Windows: MSVC 或 MinGW
  - Linux: GCC

## 开发环境配置

### 1. Qt框架安装

#### macOS安装
```bash
# 使用Homebrew安装Qt 6
brew install qt

# 设置环境变量
echo 'export PATH="/opt/homebrew/bin:$PATH"' >> ~/.zshrc
source ~/.zshrc
```

#### Windows安装
```bash
# 下载Qt在线安装器
# 访问 https://www.qt.io/download-qt-installer
# 选择Qt 6.9.0+版本，包含Qt Widgets模块
```

#### Linux安装
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install qt6-base-dev qt6-tools-dev build-essential

# Fedora
sudo dnf install qt6-qtbase-devel qt6-qttools-devel gcc-c++ make
```

### 2. 验证安装

```bash
# 检查qmake是否安装
qmake --version

# 检查Qt版本
qtpaths --qt-version

# 验证编译器
clang++ --version  # macOS
g++ --version      # Linux
cl                 # Windows
```

## 项目结构

```
Puzzle_Game/
├── PuzzleGame.pro          # 项目配置文件
├── src/                    # 源代码目录
│   ├── main.cpp           # 程序入口
│   ├── DlgMenu.*          # 主菜单界面
│   ├── play4x4.*          # 游戏主逻辑
│   ├── LevelSelect.*      # 关卡选择
│   ├── CustomMode.*       # 自定义模式
│   ├── NetworkClient.*    # 网络客户端
│   └── ...               # 其他组件
├── res/                   # 资源文件
│   └── img.qrc           # Qt资源文件
├── server/               # 服务器代码
├── build/               # 构建输出目录
├── debug/               # Debug版本输出
├── release/             # Release版本输出
└── temp/                # 临时编译文件
```

## 构建系统

### qmake项目配置

项目使用`PuzzleGame.pro`配置文件，主要配置：

```qmake
# Qt模块
QT += core gui widgets multimedia network

# 编译配置
CONFIG += c++11 warn_on debug_and_release

# 输出目录
CONFIG(debug, debug|release) {
    DESTDIR = ../debug
} else {
    DESTDIR = ../release
}

# macOS特定设置
macx {
    QMAKE_CC = clang
    QMAKE_CXX = clang++
    CONFIG += x86_64
}
```

### 构建命令

```bash
# 进入项目目录
cd /path/to/Puzzle_Game

# 生成Makefile
qmake PuzzleGame.pro

# 编译项目
make

# 或直接使用qmake构建
qmake && make

# 清理构建文件
make clean
```

### IDE配置

#### Qt Creator配置
1. 打开Qt Creator
2. File → Open File or Project → 选择`PuzzleGame.pro`
3. 选择构建套件（Desktop Qt 6.9.0+）
4. 配置构建目录
5. 点击Configure Project

#### VS Code配置
```json
// .vscode/c_cpp_properties.json
{
    "configurations": [
        {
            "name": "Mac",
            "includePath": [
                "${workspaceFolder}/**",
                "/opt/homebrew/include/**"
            ],
            "defines": [],
            "macFrameworkPath": [
                "/opt/homebrew/Frameworks/**"
            ],
            "compilerPath": "/opt/homebrew/bin/clang++",
            "cStandard": "c11",
            "cppStandard": "c++11"
        }
    ],
    "version": 4
}
```

## 依赖库

### Qt模块
- `Qt Core`: 核心功能
- `Qt GUI`: 图形界面基础
- `Qt Widgets`: 界面控件
- `Qt Multimedia`: 音频播放（音效）
- `Qt Network`: 网络通信

### 系统库
- **macOS**: 系统标准库（通过Xcode命令行工具）
- **Linux**: 标准GNU库
- **Windows**: Visual C++运行时库

## 开发工作流

### 1. 项目设置
```bash
# 克隆项目
git clone <repository-url>
cd Puzzle_Game

# 创建构建目录
mkdir -p build/Desktop-Debug
cd build/Desktop-Debug

# 生成项目
qmake ../../PuzzleGame.pro
```

### 2. 编译运行
```bash
# 编译
make

# 运行Debug版本
cd ../../debug
./PuzzleGame

# 或运行Release版本
cd ../../release
./PuzzleGame
```

### 3. 调试配置
```bash
# 启用调试信息
CONFIG += debug

# 使用LLDB调试器
lldb ./debug/PuzzleGame
```

## 资源管理

### 图片资源
- 位置: `res/img/`
- 通过Qt资源系统管理（`res/img.qrc`）
- 内置图片: `:photo/img/1.jpg` - `:photo/img/8.jpg`
- 界面元素: `:/img/blank.png`, `:/img/imageshow.jpg`

### 音效资源
- 位置: `res/sounds/`
- 包含: 移动音效、旋转音效、完成音效
- 资源前缀: `:/sounds/`

## 测试环境

### 单元测试
项目当前未配置单元测试框架，建议添加：

```qmake
# 在PuzzleGame.pro中添加
QT += testlib

# 测试源码目录
SOURCES += tests/*.cpp
HEADERS += tests/*.h
```

### 功能测试
```bash
# 运行程序测试基本功能
./debug/PuzzleGame

# 测试各游戏模式
# 1. 主菜单 → 选择难度
# 2. 拖拽操作测试
# 3. 旋转功能测试
# 4. 自定义图片测试
```

## 部署配置

### macOS应用打包
```bash
# 使用macdeploytool
macdeployqt debug/PuzzleGame.app

# 创建DMG文件
hdiutil create -volname "Puzzle Game" -srcfolder debug/PuzzleGame.app -ov -format UDZO PuzzleGame.dmg
```

### Windows部署
```bash
# 使用windeployqt
windeployqt release/PuzzleGame.exe
```

### Linux部署
```bash
# 使用linuxdeployqt
linuxdeployqt release/PuzzleGame
```

## 常见问题解决

### 编译错误
```bash
# 确保Qt环境变量设置正确
export PATH="/opt/homebrew/bin:$PATH"
export QTDIR="/opt/homebrew"

# 清理并重新生成
make clean
qmake PuzzleGame.pro
make
```

### 运行时错误
```bash
# 检查依赖库
otool -L debug/PuzzleGame  # macOS
ldd debug/PuzzleGame       # Linux

# 确保资源文件可访问
ls res/img/
```

### IDE配置问题
- 确保选择了正确的构建套件（Desktop Qt 6.9.0+）
- 检查编译器路径设置
- 验证Qt版本兼容性

## 性能优化

### 编译优化
```qmake
# 启用优化
CONFIG += release

# 优化级别
QMAKE_CXXFLAGS_RELEASE += -O2
```

### 运行时优化
- 使用Qt的图片缓存机制
- 优化内存分配策略
- 减少不必要的重绘操作

## 版本控制

### Git忽略文件
```gitignore
# 建议的.gitignore内容
build/
debug/
release/
temp/
*.user
*.pro.user*
Makefile
*.o
moc_*
ui_*
qrc_*
.DS_Store
Thumbs.db
```

## 开发工具推荐

### IDE/编辑器
- **Qt Creator**: 官方推荐，最佳Qt支持
- **Visual Studio Code**: 轻量级，插件丰富
- **CLion**: 功能强大的C++ IDE

### 调试工具
- **LLDB**: macOS默认调试器
- **GDB**: Linux调试器
- **Valgrind**: 内存泄漏检测

### 版本控制
- **Git**: 分布式版本控制
- **GitHub/GitLab**: 代码托管平台

## 文档维护

本文档位于项目根目录，应随项目更新保持同步：

- 更新Qt版本要求时同步修改
- 新增依赖库时更新依赖说明
- 修改构建配置时更新相关章节

---

**最后更新**: 2025-09-12  
**Qt版本**: 6.9.0  
**文档版本**: 1.0